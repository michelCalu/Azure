# this file calls hub + spokes

param location string = 'francecentral'
param spokeCount int = 2
param adminUsername string
@secure()
param adminPassword string

module hub 'hub/hub.bicep' = {
  name: 'hubDeployment'
  params: {
    location: location
  }
}

module spokes 'spoke/spoke.bicep' = [for i in range(0, spokeCount): {
  name: 'spoke-${i}'
  params: {
    location: location
    spokeIndex: i
    hubVnetId: hub.outputs.hubVnetId
    adminUsername: adminUsername
    adminPassword: adminPassword
  }
}]
